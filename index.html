<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>横向卷轴游戏</title>
    <style>
        body {
            margin: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            background-color: #87CEEB; /* 天空蓝 */
        }
        canvas {
            border: 2px solid #000;
        }
        #score {
            position: absolute;
            top: 10px;
            left: 10px;
            font-size: 20px;
            color: #fff;
        }
    </style>
</head>
<body>
    <div id="score">得分: 0</div>
    <canvas id="gameCanvas" width="800" height="400"></canvas>
    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');

        let playerX = 50;
        let playerY = 200;
        let backgroundX = 0;
        let score = 0;
        let enemySpeed = 3; // 敌人初始速度
        let gameSpeed = 2; // 背景滚动速度
        let frameCount = 0; // 帧计数器

        const enemies = [];
        const enemyWidth = 50;
        const enemyHeight = 50;

        // 生成敌人
        function createEnemy() {
            const enemyX = canvas.width + Math.random() * 200; // 随机生成位置
            const enemyY = Math.random() * (canvas.height - enemyHeight);
            enemies.push({ x: enemyX, y: enemyY });
        }

        // 绘制敌人
        function drawEnemies() {
            ctx.fillStyle = 'black';
            for (const enemy of enemies) {
                ctx.fillRect(enemy.x, enemy.y, enemyWidth, enemyHeight);
                enemy.x -= enemySpeed; // 敌人向左移动
            }
            // 移除超出画布的敌人
            for (let i = enemies.length - 1; i >= 0; i--) {
                if (enemies[i].x < -enemyWidth) {
                    enemies.splice(i, 1);
                    score++; // 增加得分
                }
            }
        }

        // 碰撞检测
        function checkCollision() {
            for (const enemy of enemies) {
                if (
                    playerX < enemy.x + enemyWidth &&
                    playerX + 50 > enemy.x &&
                    playerY < enemy.y + enemyHeight &&
                    playerY + 50 > enemy.y
                ) {
                    return true; // 碰撞
                }
            }
            return false;
        }

        // 绘制背景
        function drawBackground() {
            ctx.fillStyle = 'green';
            ctx.fillRect(backgroundX, 0, 1600, 400); // 背景
            backgroundX -= gameSpeed; // 背景滚动
            if (backgroundX < -800) {
                backgroundX = 0; // 重置背景位置
            }
        }

        // 绘制玩家
        function drawPlayer() {
            ctx.fillStyle = 'red';
            ctx.fillRect(playerX, playerY, 50, 50); // 玩家角色
        }

        // 更新游戏状态
        function update() {
            ctx.clearRect(0, 0, canvas.width, canvas.height); // 清空画布
            drawBackground();
            drawEnemies();
            drawPlayer();

            if (checkCollision()) {
                alert('游戏结束！得分: ' + score);
                document.location.reload(); // 重启游戏
            }

            document.getElementById('score').innerText = '得分: ' + score;

            // 每帧增加敌人速度
            frameCount++;
            if (frameCount % 100 === 0) { // 每100帧增加速度
                enemySpeed += 0.5; // 增加敌人速度
                gameSpeed += 0.1; // 增加背景滚动速度
            }

            requestAnimationFrame(update); // 请求下一帧
        }

        // 处理键盘事件
        function keyDownHandler(e) {
            if (e.key === 'ArrowUp') {
                playerY -= 100; // 向上移动
            } else if (e.key === 'ArrowDown') {
                playerY += 100; // 向下移动
            }
            // 限制玩家在画布内移动
            if (playerY < 0) playerY = 0;
            if (playerY > canvas.height - 50) playerY = canvas.height - 50;
        }

        // 每隔一段时间生成敌人
        setInterval(createEnemy, 2000);

        document.addEventListener('keydown', keyDownHandler);
        update(); // 启动游戏循环
    </script>
</body>
</html>
